<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title id="t-title">Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©</title>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body { width: 100%; overflow-x: hidden; }

    :root{
      --primary:#009bc4;
      --primary-dark:#00667f;
      --primary-soft:#e5f6f9;
      --nav-bg:#e7f5f8;
      --text-main:#23424b;
      --gold:#d4af37;
    }

    body {
      font-family: "Tajawal", sans-serif;
      background: #ffffff;
      color: #222;
      line-height: 1.6;
      direction:rtl;
    }

    /* HEADER (same feel as index) */
    header{
      padding:10px 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:var(--nav-bg);
      box-shadow:0 2px 18px rgba(0,0,0,0.07);
      position:sticky;
      top:0;
      z-index:999;
      gap:14px;
    }

    .logo{
      flex:0 0 auto;
      display:flex;
      cursor:pointer;
      justify-content:center;
    }
    .logo img{
      width:clamp(60px, 12vw, 85px);
      height:auto;
      transition:transform .2s;
    }
    .logo img:hover{transform:scale(1.05);}

    /* NAV + search */
    nav{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }
    nav ul{
      list-style:none;
      display:flex;
      align-items:center;
      gap:16px;
      justify-content:flex-start;
      flex-wrap:nowrap;
    }
    nav li{position:relative;}
    nav a{
      text-decoration:none;
      color:var(--text-main);
      font-size:13px;
      font-weight:600;
      padding:4px 2px;
      transition:.2s;
    }
    nav a:hover{color:var(--primary);}
    nav a.active{
      color:var(--primary);
    }
    nav a.active::after,
    nav a:hover::after{
      content:"";
      position:absolute;
      bottom:-2px;
      inset-inline-start:0;
      width:100%;
      height:2px;
      background:var(--primary);
      border-radius:999px;
    }

    .dropdown-content{
      display:none;
      position:absolute;
      top:100%;
      right:0;
      background:#fff;
      box-shadow:0 4px 15px rgba(0,0,0,0.13);
      padding:8px 0;
      border-radius:10px;
      min-width:210px;
      border:1px solid #e5e7eb;
      z-index:1000;
    }
    .dropdown-content a{
      display:block;
      padding:8px 16px;
      color:var(--text-main);
      white-space:nowrap;
      font-size:13px;
    }
    .dropdown-content a:hover{
      background:#f1fbff;
      color:var(--primary);
    }
    .dropdown:hover .dropdown-content{display:block;}

    /* Search bar */
    .nav-search{
      flex:0 0 150px;
      position:relative;
      display:flex;
      align-items:center;
    }
    .nav-search input{
      width:100%;
      padding:5px 26px 5px 8px;
      border-radius:999px;
      border:1px solid #cbd5e1;
      font-size:11px;
      outline:none;
    }
    .nav-search input:focus{
      border-color:var(--primary);
      box-shadow:0 0 0 2px rgba(0,155,196,0.18);
    }
    .nav-search span{
      position:absolute;
      left:8px;
      font-size:13px;
      color:#9ca3af;
    }

    /* ACTIONS + language */
    .actions{
      display:flex;
      align-items:center;
      gap:8px;
    }

    .btn{
      padding:6px 12px;
      border-radius:26px;
      border:2px solid rgba(0,155,196,0.45);
      background:rgba(0,155,196,0.06);
      cursor:pointer;
      font-weight:700;
      font-size:11px;
      transition:.2s;
      color:var(--primary-dark);
      white-space:nowrap;
    }
    .btn:hover{background:rgba(0,155,196,0.12);}
    .btn.primary{
      background:linear-gradient(90deg,var(--primary),var(--primary-dark));
      color:#fff;
      border:none;
      box-shadow:0 3px 12px rgba(0,155,196,0.25);
    }

    .lang-wrapper{position:relative;}
    .lang-toggle{
      border:none;
      background:#ffffff;
      border-radius:999px;
      padding:5px 10px;
      font-size:11px;
      cursor:pointer;
      color:var(--primary-dark);
      display:flex;
      align-items:center;
      gap:4px;
    }
    .lang-menu{
      position:absolute;
      top:115%;
      right:0;
      background:#fff;
      box-shadow:0 4px 15px rgba(0,0,0,0.13);
      border-radius:10px;
      min-width:120px;
      border:1px solid #e5e7eb;
      display:none;
      z-index:1200;
    }
    .lang-menu button{
      width:100%;
      border:none;
      background:transparent;
      padding:7px 10px;
      text-align:right;
      font-size:11px;
      cursor:pointer;
    }
    .lang-menu button:hover{background:#f3f4f6;}

    /* Gold Academic pill */
    .pill-circle{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:6px 18px;
      border-radius:999px;
      background:var(--gold);
      color:#111;
      font-weight:800;
      font-size:13px;
      box-shadow:0 0 0 2px rgba(0,0,0,0.06);
    }
    .pill-circle::before{
      content:"â—";
      font-size:9px;
      margin-left:6px;
      color:#111;
    }
    /* hide dot only inside mobile dropdown pill */
    .mobile-dropdown-toggle .pill-circle::before{
      content:"";
      display:none;
    }
    .dropdown-academic .dropdown-content a{
      font-size:13px;
    }

    /* MOBILE MENU BUTTON */
    #menu-btn{
      display:none;
      width:40px;
      height:40px;
      border-radius:50%;
      border:none;
      background:rgba(0,155,196,0.22);
      color:var(--primary-dark);
      font-size:20px;
      cursor:pointer;
      align-items:center;
      justify-content:center;
    }

    /* MOBILE MENU */
    .mobile-menu {
      display: none;
      position: fixed;
      top: 0;
      right: 0;
      width: min(80%, 350px);
      height: 100%;
      background: #fff;
      box-shadow: -3px 0 12px rgba(0,0,0,0.1);
      padding: clamp(20px, 8vw, 30px);
      z-index: 2000;
      overflow-y: auto;
    }
    .mobile-menu-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:18px;
    }
    .mobile-logo{
      width:52px;
      height:auto;
    }
    .mobile-close{
      border:none;
      background:rgba(0,155,196,0.1);
      width:36px;
      height:36px;
      border-radius:50%;
      font-size:20px;
      cursor:pointer;
      color:var(--primary-dark);
    }
    .mobile-menu ul { list-style: none; margin-top: 10px; }
    .mobile-menu ul li { margin-bottom: 18px; }
    .mobile-menu ul li a {
      font-size: clamp(18px, 5vw, 20px);
      text-decoration: none;
      color: #222;
    }

    /* Mobile academic dropdown */
    .mobile-dropdown-toggle{
      width:100%;
      background:transparent;
      border:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      font-size:14px;
      color:#222;
      cursor:pointer;
      padding:0;
    }
    .mobile-dropdown-arrow{
      font-size:11px;
      color:#6b7280;
    }
    .mobile-submenu{
      list-style:none;
      margin-top:8px;
      margin-right:14px;
      display:none;
    }
    .mobile-submenu li{
      margin-bottom:10px;
    }
    .mobile-submenu a{
      font-size:15px;
    }
    .mobile-dropdown.open .mobile-submenu{
      display:block;
    }

    /* HERO â€“ same gradient as index */
    .hero {
      padding: clamp(80px, 20vw, 110px) clamp(25px, 8vw, 40px);
      text-align: center;
      background:linear-gradient(135deg,#f6fbff,var(--primary-soft));
    }
    .hero h1 {
      font-size: clamp(24px, 8vw, 36px);
      font-weight: 800;
      color: #064b63;
      margin-bottom: clamp(12px, 4vw, 18px);
    }
    .hero p {
      font-size: clamp(16px, 4vw, 18px);
      max-width: 800px;
      margin: auto;
      color: #4b5c63;
      line-height: 1.8;
    }

    /* SECTION */
    section {
      padding: clamp(40px, 12vw, 60px) clamp(25px, 8vw, 40px);
    }
    section h2 {
      font-size: clamp(22px, 6vw, 30px);
      margin-bottom: 20px;
      color: #0d6b8c;
      border-right: 5px solid #0d6b8c;
      padding-right: 12px;
    }

    /* GRID + cards */
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(clamp(250px, 45vw, 280px), 1fr));
      gap: clamp(20px, 6vw, 25px);
    }

    .card {
      padding: clamp(15px, 4vw, 18px);
      border-radius: 14px;
      background: #fff;
      box-shadow: 0 2px 15px rgba(0,0,0,0.08);
      transition: .2s;
      position: relative;
      display: flex;
      flex-direction: column;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }
    .card h3 {
      font-size: clamp(16px, 4vw, 20px);
      margin-bottom: 8px;
      color: #0d6b8c;
      line-height: 1.4;
    }
    .card p {
      font-size: clamp(13px, 3.5vw, 15px);
      color: #555;
      line-height: 1.7;
      flex-grow: 1;
      margin-bottom: 12px;
    }

    .card button {
      margin-top: auto;
      padding: clamp(8px, 2.5vw, 10px) clamp(12px, 4vw, 16px);
      border: none;
      border-radius: 20px;
      background: #0aa2ca;
      color: #fff;
      cursor: pointer;
      transition: .2s;
      font-weight: 600;
      font-size: clamp(13px, 3.5vw, 15px);
    }
    .card button:hover {
      background: #078fa8;
      transform: scale(1.02);
    }

    /* FOOTER â€“ same main color */
    footer {
      margin-top: clamp(30px, 8vw, 40px);
      padding: clamp(25px, 8vw, 35px);
      background: #0d6b8c;
      color: #fff;
      text-align: center;
      font-size: clamp(15px, 4vw, 18px);
    }

    /* TOAST */
    .toast-container {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 5000;
    }
    .toast {
      background: #fff;
      padding: clamp(12px, 3vw, 16px) clamp(16px, 4vw, 20px);
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      gap: 12px;
      animation: slideIn 0.3s ease-in-out;
      max-width: 90vw;
    }
    .toast.error { border-right: 4px solid #ff5454; }
    .toast.success { border-right: 4px solid #22c55e; }
    .toast.warning { border-right: 4px solid #fbbf24; }
    .toast.info { border-right: 4px solid #3b82f6; }
    .toast-icon { font-size: clamp(18px, 5vw, 20px); }
    .toast-message {
      color: #333;
      font-weight: 500;
      font-size: clamp(14px, 3.5vw, 16px);
    }
    @keyframes slideIn {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(-100%); opacity: 0; }
    }
    .toast.removing { animation: slideOut 0.3s ease-in-out; }

    /* RESPONSIVE */
    @media(max-width:1100px){
      .nav-search{display:none;}
    }

    @media(max-width: 980px){
      nav{display:none;}
      .actions{display:none;}
      #menu-btn{
        display:flex;
        order:-1;
      }
      header{
        justify-content:center;
      }
      .logo{
        margin-inline:auto;
      }

      .toast-container {
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
      }

      /* slightly smaller pill in mobile menu */
      .mobile-menu .pill-circle{
        padding:4px 14px;
        font-size:12px;
      }
    }

    @media(max-width: 768px){
      header { padding: 12px 16px; }
      .hero {
        padding: 70px 25px;
      }
      section { padding: 50px 20px; }
      .grid {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
      }
    }

    @media(max-width: 600px){
      .hero h1 { font-size: 28px; }
      .hero p { font-size: 16px; }
      section { padding: 40px 15px; }
      section h2 { font-size: 24px; }
      .grid {
        grid-template-columns: 1fr;
        gap: 18px;
      }
      .card { padding: 20px; }
    }

    @media(max-width: 480px){
      header { padding: 10px 14px; }
      .logo img { width: 65px; }
      .hero { padding: 60px 15px; }
      section { padding: 35px 12px; }
      section h2 { font-size: 22px; }
      .card h3 { font-size: 18px; }
      .card button { font-size: 15px; }
    }

    @media(max-width: 360px){
      .hero h1 { font-size: 24px; }
      .hero p { font-size: 15px; }
      section h2 { font-size: 20px; }
      .card { padding: 18px; }
    }
  </style>
</head>

<body>
<!-- MOBILE MENU -->
<div class="mobile-menu" id="mobileMenu">
  <div class="mobile-menu-header">
    <img src="images/logo.png" class="mobile-logo" alt="Logo">
    <button class="mobile-close" type="button" onclick="toggleMenu()">âœ•</button>
  </div>
  <ul>
    <li><a href="index.html" data-t="nav_home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
    <li><a href="research.html" data-t="nav_research_peer">Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©</a></li>
    <li><a href="articles.html" data-t="nav_articles_peer">Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ø­ÙƒÙ…Ø©</a></li>
    <li><a href="files.html" data-t="nav_files">Ù…Ù„ÙØ§Øª Ø¨Ø­Ø«ÙŠØ©</a></li>
    <li><a href="articles-foreign.html" data-t="nav_foreign">Ù…Ù‚Ø§Ù„Ø§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©</a></li>
    <li><a href="general-articles.html" data-t="nav_articles">Ù…Ù‚Ø§Ù„Ø§Øª</a></li>
    <li><a href="editions.html" data-t="nav_editions">Ø¥ØµØ¯Ø§Ø±Ø§ØªÙ†Ø§</a></li>
    <li><a href="activities.html" data-t="nav_activities">Ø£Ù†Ø´Ø·ØªÙ†Ø§</a></li>

    <!-- Academic dropdown in mobile -->
    <li class="mobile-dropdown">
      <button type="button" class="mobile-dropdown-toggle">
        <span class="pill-circle" data-t="nav_academic">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</span>
        <span class="mobile-dropdown-arrow">â–¾</span>
      </button>
      <ul class="mobile-submenu">
        <li><a href="special-politics.html" data-t="sp_politics">ØªØ®ØµØµ Ø¹Ù„ÙˆÙ… Ø³ÙŠØ§Ø³ÙŠØ©</a></li>
        <li><a href="special-ir.html" data-t="sp_ir">ØªØ®ØµØµ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©</a></li>
        <li><a href="special-admin-law.html" data-t="sp_admin_law">ØªØ®ØµØµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</a></li>
        <li><a href="special-const-law.html" data-t="sp_const_law">ØªØ®ØµØµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¯Ø³ØªÙˆØ±ÙŠ</a></li>
        <li><a href="special-public-policy.html" data-t="sp_public_policy">ØªØ®ØµØµ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</a></li>
      </ul>
    </li>

    <li><a href="live.html" data-t="nav_live">Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±</a></li>
    <li><a href="rules.html" data-t="nav_rules">Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø´Ø±</a></li>
    <li><a href="contact.html" data-t="nav_contact">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a></li>
    <li id="mobileLogin"><a href="login.html" data-t="nav_login">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a></li>
    <li id="mobileRegister"><a href="register.html" data-t="nav_join">Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§</a></li>
  </ul>
</div>

<div class="toast-container" id="toastContainer"></div>

<header>
  <button id="menu-btn" onclick="toggleMenu()">â˜°</button>

  <div class="logo" onclick="goToHome()">
    <img src="images/logo.png" alt="Logo">
  </div>

  <nav>
    <ul>
      <li><a href="index.html" data-t="nav_home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>

      <li class="dropdown">
        <a href="#" data-t="nav_studies">Ø£Ø¨Ø­Ø§Ø« ÙˆØ¯Ø±Ø§Ø³Ø§Øª â–¾</a>
        <div class="dropdown-content">
          <a href="research.html" class="active" data-t="nav_research_peer">Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©</a>
          <a href="articles.html" data-t="nav_articles_peer">Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ø­ÙƒÙ…Ø©</a>
          <a href="files.html" data-t="nav_files">Ù…Ù„ÙØ§Øª Ø¨Ø­Ø«ÙŠØ©</a>
          <a href="articles-foreign.html" data-t="nav_foreign">Ù…Ù‚Ø§Ù„Ø§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©</a>
        </div>
      </li>

      <li><a href="general-articles.html" data-t="nav_articles">Ù…Ù‚Ø§Ù„Ø§Øª</a></li>
      <li><a href="editions.html" data-t="nav_editions">Ø¥ØµØ¯Ø§Ø±Ø§ØªÙ†Ø§</a></li>
      <li><a href="activities.html" data-t="nav_activities">Ø£Ù†Ø´Ø·ØªÙ†Ø§</a></li>

      <li class="dropdown dropdown-academic">
        <a href="#academic" class="pill-circle" data-t="nav_academic">Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</a>
        <div class="dropdown-content">
          <a href="special-politics.html" data-t="sp_politics">ØªØ®ØµØµ Ø¹Ù„ÙˆÙ… Ø³ÙŠØ§Ø³ÙŠØ©</a>
          <a href="special-ir.html" data-t="sp_ir">ØªØ®ØµØµ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©</a>
          <a href="special-admin-law.html" data-t="sp_admin_law">ØªØ®ØµØµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</a>
          <a href="special-const-law.html" data-t="sp_const_law">ØªØ®ØµØµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¯Ø³ØªÙˆØ±ÙŠ</a>
          <a href="special-public-policy.html" data-t="sp_public_policy">ØªØ®ØµØµ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</a>
        </div>
      </li>

      <li><a href="live.html" data-t="nav_live">Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±</a></li>
      <li><a href="rules.html" data-t="nav_rules">Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø´Ø±</a></li>
      <li><a href="contact.html" data-t="nav_contact">Ø§ØªØµÙ„ Ø¨Ù†Ø§</a></li>
    </ul>

    <form class="nav-search" onsubmit="doSearch(event)">
      <input type="search" id="navSearchInput" placeholder="Ø§Ø¨Ø­Ø«..." />
      <span>ğŸ”</span>
    </form>
  </nav>

  <div class="actions" id="headerActions">
    <div class="lang-wrapper">
      <button class="lang-toggle" onclick="toggleLangMenu()">
        <span id="langCurrent">AR</span> â–¾
      </button>
      <div class="lang-menu" id="langMenu">
        <button onclick="setLang('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        <button onclick="setLang('en')">English</button>
        <button onclick="setLang('fr')">FranÃ§ais</button>
      </div>
    </div>
    <button class="btn" onclick="location.href='login.html'" data-t="nav_login">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    <button class="btn primary" onclick="location.href='register.html'" data-t="nav_join">Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§</button>
  </div>
</header>

<div class="hero">
  <h1 data-t="hero_title_research">Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©</h1>
  <p data-t="hero_sub_research">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰" Ù„ÙØªØ­ Ø§Ù„Ø¨Ø­Ø«. ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.</p>
</div>

<section>
  <h2 data-t="sec_research_list">Ø§Ù„Ø£Ø¨Ø­Ø§Ø«</h2>
  <div class="grid" id="researchGrid"></div>
</section>

<footer data-t="footer_text">
  Â© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€“ Ù…Ù†ØµØªÙƒ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©
</footer>

<script>
  function goToHome(){window.location.href='index.html';}

  function toggleMenu(){
    const menu=document.getElementById("mobileMenu");
    const btn=document.getElementById("menu-btn");
    const open=menu.style.display==="block";
    menu.style.display=open?"none":"block";
    if(btn){ btn.textContent=open?"â˜°":"âœ•"; }
  }

  function doSearch(e){
    e.preventDefault();
    const input=document.getElementById('navSearchInput');
    const q=input ? input.value.trim() : "";
    if(!q) return;
    window.location.href='search.html?q='+encodeURIComponent(q);
  }

  function toggleLangMenu(){
    const menu=document.getElementById("langMenu");
    if(!menu) return;
    menu.style.display = menu.style.display==="block" ? "none" : "block";
  }
  document.addEventListener('click',e=>{
    if(!e.target.closest('.lang-wrapper')){
      const m=document.getElementById('langMenu');
      if(m) m.style.display='none';
    }
  });

  function showToast(message, type = 'info') {
    const container = document.getElementById('toastContainer');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    const icons = {error:'âŒ',success:'âœ…',warning:'âš ï¸',info:'â„¹ï¸'};
    toast.innerHTML = `
      <span class="toast-icon">${icons[type]}</span>
      <span class="toast-message">${message}</span>
    `;
    container.appendChild(toast);
    setTimeout(() => {
      toast.classList.add('removing');
      setTimeout(() => toast.remove(), 300);
    }, 3000);
  }

  let user = JSON.parse(localStorage.getItem("user") || "null");
  const headerActions = document.getElementById("headerActions");
  const mobileLogin = document.getElementById("mobileLogin");
  const mobileRegister = document.getElementById("mobileRegister");

  function updateHeader() {
    if (user && user.username) {
      headerActions.innerHTML = `
        <div class="lang-wrapper">
          <button class="lang-toggle" onclick="toggleLangMenu()">
            <span id="langCurrent">AR</span> â–¾
          </button>
          <div class="lang-menu" id="langMenu">
            <button onclick="setLang('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
            <button onclick="setLang('en')">English</button>
            <button onclick="setLang('fr')">FranÃ§ais</button>
          </div>
        </div>
        <span style="margin-right:12px;font-size:13px;">${user.username}</span>
        <button class="btn primary" onclick="logout()" data-t="logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
      `;
      if(mobileLogin)  mobileLogin.innerHTML = `<a href="#" onclick="logout()" data-t="logout">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>`;
      if(mobileRegister) mobileRegister.style.display = "none";
    }
  }

  function logout() {
    localStorage.removeItem("user");
    user = null;
    showToast(t('toast_logout_success'), 'success');
    setTimeout(() => location.reload(), 500);
  }

  const researchGrid = document.getElementById("researchGrid");
  const researchData = JSON.parse(localStorage.getItem('research') || '[]');

  const translations = {
    ar:{title:"Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©",nav_home:"Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",nav_studies:"Ø£Ø¨Ø­Ø§Ø« ÙˆØ¯Ø±Ø§Ø³Ø§Øª â–¾",nav_research_peer:"Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©",
        nav_articles_peer:"Ù…Ù‚Ø§Ù„Ø§Øª Ù…Ø­ÙƒÙ…Ø©",nav_files:"Ù…Ù„ÙØ§Øª Ø¨Ø­Ø«ÙŠØ©",nav_foreign:"Ù…Ù‚Ø§Ù„Ø§Øª Ø£Ø¬Ù†Ø¨ÙŠØ©",nav_articles:"Ù…Ù‚Ø§Ù„Ø§Øª",
        nav_editions:"Ø¥ØµØ¯Ø§Ø±Ø§ØªÙ†Ø§",nav_activities:"Ø£Ù†Ø´Ø·ØªÙ†Ø§",nav_academic:"Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ",nav_live:"Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±",nav_rules:"Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø´Ø±",
        nav_contact:"Ø§ØªØµÙ„ Ø¨Ù†Ø§",nav_login:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",nav_join:"Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§",hero_title_research:"Ø£Ø¨Ø­Ø§Ø« Ù…Ø­ÙƒÙ…Ø©",
        hero_sub_research:"Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ \"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰\" Ù„ÙØªØ­ Ø§Ù„Ø¨Ø­Ø«. ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.",sec_research_list:"Ø§Ù„Ø£Ø¨Ø­Ø§Ø«",
        footer_text:"Â© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€“ Ù…Ù†ØµØªÙƒ Ø§Ù„Ø¹Ù„Ù…ÙŠØ©",logout:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
        toast_logout_success:"ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­",toast_open_research:"Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ø§Ù„Ø¨Ø­Ø«...",
        toast_login_required:"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰",no_research:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¨Ø­Ø§Ø« Ø­Ø§Ù„ÙŠØ§Ù‹",
        btn_view_content:"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰",sp_politics:"ØªØ®ØµØµ Ø¹Ù„ÙˆÙ… Ø³ÙŠØ§Ø³ÙŠØ©",sp_ir:"ØªØ®ØµØµ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¯ÙˆÙ„ÙŠØ©",
        sp_admin_law:"ØªØ®ØµØµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ",sp_const_law:"ØªØ®ØµØµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¯Ø³ØªÙˆØ±ÙŠ",
        sp_public_policy:"ØªØ®ØµØµ Ø§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©"},
    en:{title:"Peer-reviewed research",nav_home:"Home",nav_studies:"Research & Studies â–¾",
        nav_research_peer:"Peer-reviewed research",nav_articles_peer:"Scholarly Articles",nav_files:"Research Files",
        nav_foreign:"Foreign Articles",nav_articles:"Articles",nav_editions:"Our Publications",
        nav_activities:"Activities",nav_academic:"Academic",nav_live:"Live",nav_rules:"Submission Rules",
        nav_contact:"Contact us",nav_login:"Login",nav_join:"Join us",
        hero_title_research:"Peer-reviewed research",
        hero_sub_research:"Click â€œView contentâ€ to open the paper. You must log in first.",
        sec_research_list:"Research",footer_text:"Â© All rights reserved â€“ Your Academic Platform",
        logout:"Logout",toast_logout_success:"Logged out successfully",toast_open_research:"Opening research...",
        toast_login_required:"You must log in to view the content",no_research:"No research items yet",
        btn_view_content:"View content",sp_politics:"Political Science",sp_ir:"International Relations",
        sp_admin_law:"Administrative Law",sp_const_law:"Constitutional Law",sp_public_policy:"Public Policy"},
    fr:{title:"Recherches Ã©valuÃ©es",nav_home:"Accueil",nav_studies:"Recherches et Ã©tudes â–¾",
        nav_research_peer:"Recherches Ã©valuÃ©es",nav_articles_peer:"Articles scientifiques",
        nav_files:"Dossiers de recherche",nav_foreign:"Articles Ã©trangers",nav_articles:"Articles",
        nav_editions:"Nos publications",nav_activities:"ActivitÃ©s",nav_academic:"AcadÃ©mique",
        nav_live:"Direct",nav_rules:"Conditions de publication",nav_contact:"Contactez-nous",
        nav_login:"Connexion",nav_join:"Rejoignez-nous",
        hero_title_research:"Recherches Ã©valuÃ©es",
        hero_sub_research:"Cliquez sur Â« Voir le contenu Â» pour ouvrir la recherche. Vous devez d'abord vous connecter.",
        sec_research_list:"Recherches",footer_text:"Â© Tous droits rÃ©servÃ©s â€“ Votre plateforme scientifique",
        logout:"DÃ©connexion",toast_logout_success:"DÃ©connexion rÃ©ussie",toast_open_research:"Ouverture de la recherche...",
        toast_login_required:"Vous devez vous connecter pour voir le contenu",no_research:"Aucune recherche pour le moment",
        btn_view_content:"Voir le contenu",sp_politics:"Science politique",sp_ir:"Relations internationales",
        sp_admin_law:"Droit administratif",sp_const_law:"Droit constitutionnel",sp_public_policy:"Politiques publiques"}
  };

  let currentLang = localStorage.getItem('lang') || 'ar';

  function t(key){
    const dict = translations[currentLang] || translations.ar;
    return dict[key] || '';
  }

  function setLang(lang){
    currentLang = lang;
    localStorage.setItem('lang', lang);
    const dict = translations[lang] || translations.ar;

    document.documentElement.lang = lang;
    document.documentElement.dir  = (lang === 'en' || lang === 'fr') ? 'ltr' : 'rtl';

    const titleEl = document.getElementById('t-title');
    if(titleEl && dict.title) titleEl.textContent = dict.title;

    const langCurrent = document.getElementById('langCurrent');
    if(langCurrent) langCurrent.textContent = lang.toUpperCase();

    document.querySelectorAll("[data-t]").forEach(el=>{
      const key=el.getAttribute("data-t");
      if(dict[key]) el.textContent = dict[key];
    });

    const menu=document.getElementById("langMenu");
    if(menu) menu.style.display="none";

    renderResearch();
  }

  function renderResearch(){
    researchGrid.innerHTML = '';
    if (researchData.length === 0) {
      researchGrid.innerHTML =
        `<div style="grid-column: 1/-1; text-align:center; color:#999; padding: clamp(40px, 15vw, 60px); font-size: clamp(16px, 4vw, 18px);">
          ${t('no_research')}
        </div>`;
      return;
    }
    researchData.forEach((item) => {
      const card = document.createElement("div");
      card.className = "card";
      const imgHTML = item.image
        ? `<img src="${item.image}" style="width:100%; height: clamp(120px, 25vw, 150px); object-fit: cover; border-radius: 10px; margin-bottom: 10px;" alt="">`
        : '';
      card.innerHTML = `
        ${imgHTML}
        <h3>${item.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</h3>
        <p>${item.short || ''}</p>
      `;
      const btn = document.createElement("button");
      btn.innerText = t('btn_view_content');
      btn.onclick = () => {
        if(user && user.username){
          localStorage.setItem('researchView', JSON.stringify(item));
          showToast(t('toast_open_research'), 'info');
          setTimeout(() => window.open('research-view.html', '_blank'), 500);
        } else {
          showToast(t('toast_login_required'), 'error');
        }
      };
      card.appendChild(btn);
      researchGrid.appendChild(card);
    });
  }

  function initMobileDropdowns(){
    document.querySelectorAll('.mobile-dropdown-toggle').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const parent = btn.closest('.mobile-dropdown');
        if(parent){
          parent.classList.toggle('open');
        }
      });
    });
  }

  window.addEventListener('DOMContentLoaded',()=>{
    updateHeader();
    setLang(currentLang);
    initMobileDropdowns();
  });
</script>

</body>
</html>
